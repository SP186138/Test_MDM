REPLACE VIEW MDM.MDM.SUBSCRPTN_OPT AS SELECT * FROM icrm_tbl.SUBSCRPTN_OPT ;

REPLACE VIEW MDM.REGIS_PRSNA_SOC_NETK_ACT AS SELECT * FROM icrm_tbl.REGIS_PRSNA_SOC_NET_ACCT ;

REPLACE VIEW MDM.REGIS_PRSNA_PHONE AS SELECT * FROM icrm_tbl.REGIS_PRSNA_PHONE ;

REPLACE VIEW MDM.REGIS_PRSNA_EMAIL_ADDR AS SELECT * FROM icrm_tbl.REGIS_PRSNA_EMAIL_ADDR ;

REPLACE VIEW MDM.PRSNA_TRT AS SELECT * FROM icrm_tbl.PRSNA_TRT ;

REPLACE VIEW MDM.PREDFND_TRT_VAL AS SELECT * FROM icrm_tbl.PREDFND_TRT_VAL ;

REPLACE VIEW MDM.PET_TRT AS SELECT * FROM icrm_tbl.PET_TRT ;

REPLACE VIEW MDM.PET AS SELECT * FROM icrm_tbl.PET ;

REPLACE VIEW MDM.MATCHD_CNSMR_SOC_NETK_ACT AS SELECT * FROM icrm_tbl.MATCHD_CNSMR_SOC_NET_ACCT ;

REPLACE VIEW MDM.MATCHD_CNSMR_POSTL_ADDR AS SELECT * FROM icrm_tbl.MATCHD_CNSMR_POSTL_ADDR ;

REPLACE VIEW MDM.MATCHD_CNSMR_PHONE AS SELECT * FROM icrm_tbl.MATCHD_CNSMR_PHONE ;

REPLACE VIEW MDM.MATCHD_CNSMR_EMAIL_ADDR AS SELECT * FROM icrm_tbl.MATCHD_CNSMR_EMAIL_ADDR ;

REPLACE VIEW MDM.DPEND_TRT AS SELECT * FROM icrm_tbl.DPEND_TRT ;

REPLACE VIEW MDM.CNTCT_OPT_PGM AS SELECT * FROM icrm_tbl.CNTCT_OPT_PGM ;

REPLACE VIEW MDM.CNSMR_AFFLTN AS SELECT * FROM icrm_tbl.CNSMR_AFFLTN ;

--REPLACE VIEW MDM.ATTRIBUTE_VALUES_RELN AS SELECT * FROM icrm_tbl.ATTRIBUTE_VALUES_RELN ;

--REPLACE VIEW MDM.ATTRIBUTE_VALUES_HIERARCHY AS SELECT * FROM icrm_tbl.ATTRIBUTE_VALUES_HIERARCHY ;

REPLACE VIEW MDM.ADDTL_GEOC_AREA AS SELECT * FROM icrm_tbl.ADDTL_GEOC_AREA ;

REPLACE VIEW MDM.TRT AS SELECT * FROM icrm_tbl.TRT ;

REPLACE VIEW MDM.TERR AS SELECT * FROM icrm_tbl.TERR ;

REPLACE VIEW MDM.SUBSCRPTN_OPT_TYPE AS SELECT * FROM icrm_tbl.SUBSCRPTN_OPT_TYPE ;

REPLACE VIEW MDM.REGIS_PRSNA_POSTL_ADDR AS SELECT * FROM icrm_tbl.REGIS_PRSNA_POSTL_ADDR ;

REPLACE VIEW MDM.REGIS_PRSNA AS SELECT * FROM icrm_tbl.REGIS_PRSNA ;

REPLACE VIEW MDM.MKTNG_PGM AS SELECT * FROM icrm_tbl.MKTNG_PGM ;

REPLACE VIEW MDM.MATCHD_CNSMR_PRSNA AS SELECT * FROM icrm_tbl.MATCHD_CNSMR_PRSNA ;

REPLACE VIEW MDM.HSHLD_PRSNA AS SELECT * FROM icrm_tbl.HSHLD_PRSNA ;

REPLACE VIEW MDM.DPEND AS SELECT * FROM icrm_tbl.DPEND ;

REPLACE VIEW MDM.CNSMR_GRP AS SELECT * FROM icrm_tbl.CNSMR_GRP ;

--REPLACE VIEW MDM.ATTRIBUTE_VALUES AS SELECT * FROM icrm_tbl.ATTRIBUTE_VALUES ;

--REPLACE VIEW MDM.WINKEY_TRIGGER AS SELECT * FROM icrm_tbl.WINKEY_TRIGGER ;

REPLACE VIEW MDM.TRT_ENT_TYPE AS SELECT * FROM icrm_tbl.TRT_ENT_TYPE ;

--REPLACE VIEW MDM.TRILLIUM_OUTPUT AS SELECT * FROM icrm_tbl.TRILLIUM_OUTPUT ;

--REPLACE VIEW MDM.TRILLIUM_MDM_REFERENCE AS SELECT * FROM icrm_tbl.TRILLIUM_MDM_REFERENCE ;

REPLACE VIEW MDM.PRSNA_STATUS AS SELECT * FROM icrm_tbl.PRSNA_STATUS ;

--REPLACE VIEW MDM.LOAD_INFO AS SELECT * FROM icrm_tbl.LOAD_INFO ;

REPLACE VIEW MDM.LEGAL_ENT AS SELECT * FROM icrm_tbl.LEGAL_ENT ;

REPLACE VIEW MDM.LANG AS SELECT * FROM icrm_tbl.LANG ;

REPLACE VIEW MDM.GEOC_AREA_TYPE AS SELECT * FROM icrm_tbl.GEOC_AREA_TYPE ;

REPLACE VIEW MDM.EMAIL_FORMT AS SELECT * FROM icrm_tbl.EMAIL_FORMT ;

REPLACE VIEW MDM.DPEND_TYPE AS SELECT * FROM icrm_tbl.DPEND_TYPE ;

REPLACE VIEW MDM.CNTRY AS SELECT * FROM icrm_tbl.CNTRY ;

REPLACE VIEW MDM.CNTCT_CHANL_TYPE AS SELECT * FROM icrm_tbl.CNTCT_CHANL_TYPE ;

REPLACE VIEW MDM.CNSMR_GRP_TYPE AS SELECT * FROM icrm_tbl.CNSMR_GRP_TYPE ;

--REPLACE VIEW MDM.ATTRIBUTE_TYPES_RELN AS SELECT * FROM icrm_tbl.ATTRIBUTE_TYPES_RELN ;

--REPLACE VIEW MDM.ATTRIBUTE_TYPES AS SELECT * FROM icrm_tbl.ATTRIBUTE_TYPES ;

REPLACE VIEW MDM.MDM_LOAD_CONTROL
AS
LOCKING ROW FOR ACCESS
SELECT DISTINCT A.LOAD_ID FROM ETL_CTRL.LOAD_CONTROL A
LEFT OUTER JOIN ETL_CTRL.LOAD_CONTROL B
ON A.LOAD_ID = B.LOAD_ID
AND B.LOAD_TYPE = 'MDM'
WHERE
(B.LOAD_ID IS NULL OR B.LOADSTATUS = 'RESTART')
AND A.LOAD_TYPE = 'ETL'
AND A.LOADSTATUS = 'SUCCESS'
AND A.TARGETCNT IS NOT NULL
AND A.FORMAT_ID = 1
;