show VIEW MDM.V_RPT_DATA_NBR

REPLACE VIEW MDM.V_RPT_DATA_NBR
AS
LOCKING ROW FOR ACCESS
 SELECT 
 A.LEGAL_ENT_NBR,
 B.MTCHD_CNSMR_NBR,
 B.HSHLD_NBR,
 A.MKTNG_PGM_NBR,
 A.STAGING_NBR,
 A.ERROR_NBR,
 A.ACTIVE_NBR,
 A.DUPLICATE_NBR,
 A.PHONE_OPT_IN, 
 A.PHONE_OPT_OUT, 
 A.EMAIL_OPT_IN, 
 A.EMAIL_OPT_OUT, 
 A.POSTAL_OPT_IN, 
 A.POSTAL_OPT_OUT, 
 A.SOCIAL_OPT_IN, 
 A.SOCIAL_OPT_OUT
 FROM 
 MDM.RPT_DATA_NBR A
 INNER JOIN 
(SELECT
R.MKTNG_PGM_NBR,
COUNT(DISTINCT R.MATCHD_CNSMR_PRSNA_ID) AS MTCHD_CNSMR_NBR,
COUNT(DISTINCT M.HSHLD_PRSNA_ID) AS HSHLD_NBR
FROM
REGIS_PRSNA R
INNER JOIN
MATCHD_CNSMR_PRSNA M
ON
R.MATCHD_CNSMR_PRSNA_ID = M.MATCHD_CNSMR_PRSNA_ID
AND R.PRSNA_STATUS_CODE='AC'
GROUP BY 1)B
ON
A.MKTNG_PGM_NBR = B.MKTNG_PGM_NBR;