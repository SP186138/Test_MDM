
/*.LOGON 10.35.39.87/mdmtril,$tdwallet(mdmtril);*/
.RUN FILE \\10.138.21.14\Teradata\MDM\3.05.02\custom\pngrelease3\logON\LOGON_MDM.txt;

.SET ERROROUT STDOUT;

DATABASE MDM;

.IMPORT VARTEXT ',' LOBCOLS=1 FILE=E:\Teradata\MDM\3.05.02\custom\pngrelease3\bin\INCTV.txt
USING (Test1 XML AS DEFERRED, schemaid varchar(32))
INSERT into MDM.INCTV_XML values(:schemaid, :Test1);

.IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;

DELETE FROM MDM.INCTV_ITEM_STG_VIEW;
.IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;

DELETE FROM MDM.INCTV_ITEM_STG_V_VIEW;
.IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;



INSERT INTO MDM.INCTV_ITEM_STG_VIEW(INCTV_ITEM_QTY,
BRAND_CODE,
CATEG_CODE ,
PROD_ITEM_UPC,
SEG_CODE ,
INCTV_ITEM_NAME,
INCTV_ITEM_DESC ,
ITEM_VERS_CODE ,
GLOBAL_FORM_CODE,
SUB_BRAND_CODE,
BRAND_FAMLY_ID,
PROD_FAMLY_ID,
INCTV_ITEM_NBR,
INCTV_NBR
)
SELECT X.*,CSUM(1,1) AS INCTV_ITEM_NBR, 29686 AS INCTV_NBR
FROM  (
SEL *
FROM MDM.INCTV_XML
WHERE Loadid = 1) AS C,
XMLTABLE (    '/REQUEST/INCTV/INCTV_ITEM'     PASSING C.xmlfile
COLUMNS
"INCTV_ITEM_QTY" VARCHAR(100) PATH 'INCTV_ITEM_QTY/@Value' ,
"BRAND_CODE" VARCHAR(100) PATH 'BRAND_CODE/@Value'  ,
"CATEG_CODE" VARCHAR(100) PATH 'CATEG_CODE/@Value'  ,
"PROD_ITEM_UPC" VARCHAR(100) PATH 'PROD_ITEM_UPC/@Value'  ,
"SEG_CODE" VARCHAR(100) PATH 'SEG_CODE/@Value'  ,
"INCTV_ITEM_NAME" VARCHAR(100) PATH 'INCTV_ITEM_NAME/@Value'  ,
"INCTV_ITEM_DESC" VARCHAR(100) PATH 'INCTV_ITEM_DESC/@Value'  ,
"ITEM_VERS_CODE" VARCHAR(100) PATH 'ITEM_VERS_CODE/@Value'  ,
"GLOBAL_FORM_CODE" VARCHAR(100) PATH 'GLOBAL_FORM_CODE/@Value'  ,
"SUB_BRAND_CODE" VARCHAR(100) PATH 'SUB_BRAND_CODE/@Value',
"BRAND_FAMLY_ID" VARCHAR(100) PATH 'BRAND_FAMLY_ID/@Value',
"PROD_FAMLY_ID" VARCHAR(100) PATH 'PROD_FAMLY_ID/@Value'
) AS X;

.IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;

.EXIT