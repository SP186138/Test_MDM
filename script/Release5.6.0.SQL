.logon $TDPID/$TDUSER,$TDPWD


.SET ERROROUT STDOUT;
.SET SESSION CHARSET 'UTF8';

DATABASE MDM;
.GOTO $Step

.LABEL L0
CREATE MULTISET TABLE MDM.OPT_OUT_CHK_RPT ,NO FALLBACK ,
     NO BEFORE JOURNAL,
     NO AFTER JOURNAL,
     CHECKSUM = DEFAULT,
     DEFAULT MERGEBLOCKRATIO
     (
      RPT_DATE DATE FORMAT 'YY/MM/DD' NOT NULL,
      OPT_CHK_DESC VARCHAR(200) CHARACTER SET LATIN NOT CASESPECIFIC,
      MKTNG_PGM_NBR INTEGER,
      NOT_OPTED_OUT_CNT BIGINT)
PRIMARY INDEX OPT_OUT_CHK_RPT_NUPI ( RPT_DATE ,OPT_CHK_DESC);
 .IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;
 
 .LABEL L1
 CREATE MULTISET TABLE MDM.I60_USE_CASES ,NO FALLBACK ,
      NO BEFORE JOURNAL,
      NO AFTER JOURNAL,
      CHECKSUM = DEFAULT,
      DEFAULT MERGEBLOCKRATIO
      (
       CASE_NBR VARCHAR(100) CHARACTER SET LATIN NOT CASESPECIFIC NOT NULL,
       MKTNG_PGM_NBR INTEGER,
       SUBSCRPTN_OPT_NBR INTEGER COMPRESS 9999 ,
       CHANNEL_IND VARCHAR(3) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS ('ALL','E','A'),
       OPT_LEVEL_IND CHAR(1) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS ('H','M','R'))
 PRIMARY INDEX I60_USE_CASES_UPI ( CASE_NBR);
 .IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;
 
  .LABEL L2
 INS MDM.I60_USE_CASES
  SEL 'case1' case_type,9999 MKTNG_PGM_NBR,9999 SUBSCRPTN_OPT_NBR ,'ALL' 
 CHANNEL_IND,'M' OPT_LEVEL_IND FROM MDM.ENV_NM
 UNION
 SEL 'case2' , CAST(NULL AS INTEGER),9999,'ALL','M'  FROM MDM.ENV_NM
 UNION
 SEL 'case3' , CAST(NULL AS INTEGER),9999,CAST(NULL AS VARCHAR(10)) ,'R'  
 FROM MDM.ENV_NM
 UNION
 SEL 'case4' , CAST(NULL AS INTEGER),CAST(NULL AS INTEGER),'ALL','M'  FROM 
 MDM.ENV_NM
 UNION
 SEL 'case5' , CAST(NULL AS INTEGER),CAST(NULL AS INTEGER),'ALL','R'  FROM 
 MDM.ENV_NM
 UNION
 SEL 'case6' , CAST(NULL AS INTEGER),CAST(NULL AS INTEGER),CAST(NULL AS 
 VARCHAR(10)),'R'  FROM MDM.ENV_NM
 UNION
 SEL 'case7' , 9999,9999,'ALL','H'  FROM MDM.ENV_NM
 UNION
SEL 'case8' , 9999,9999,'A','M'  FROM MDM.ENV_NM;
 .IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;
 
  .LABEL L3 
 COLLECT STATS MDM.I60_USE_CASES
 COLUMN MKTNG_PGM_NBR;
 COLLECT STATS MDM.I60_USE_CASES
 COLUMN SUBSCRPTN_OPT_NBR;
 COLLECT STATS MDM.I60_USE_CASES
 COLUMN CHANNEL_IND;
 COLLECT STATS MDM.I60_USE_CASES
 COLUMN OPT_LEVEL_IND;
  .IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;
  
  .LABEL L4
  CREATE SET TABLE MDM.OPT_OUT_CHK_LOAD_ID_IGN ,NO FALLBACK ,
       NO BEFORE JOURNAL,
       NO AFTER JOURNAL,
       CHECKSUM = DEFAULT,
       DEFAULT MERGEBLOCKRATIO
       (
        LOG_SOURCE_ID DECIMAL(18,0))
  PRIMARY INDEX OPT_OUT_CHK_LOAD_ID_IGN_UPI ( LOG_SOURCE_ID);
 .IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;
  
  .LABEL L5 
 INS MDM.OPT_OUT_CHK_LOAD_ID_IGN
 VALUES ( 29834);
  INS MDM.OPT_OUT_CHK_LOAD_ID_IGN
 VALUES (53934 );
INS MDM.OPT_OUT_CHK_LOAD_ID_IGN
 VALUES ( 31634 );
INS MDM.OPT_OUT_CHK_LOAD_ID_IGN
 VALUES ( 77834 );
INS MDM.OPT_OUT_CHK_LOAD_ID_IGN
 VALUES ( 36434 );
INS MDM.OPT_OUT_CHK_LOAD_ID_IGN
 VALUES ( 223434 );
INS MDM.OPT_OUT_CHK_LOAD_ID_IGN
 VALUES ( 118134 );
INS MDM.OPT_OUT_CHK_LOAD_ID_IGN
 VALUES ( 55434 );
 .IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;

  .LABEL L6 
  COLLECT STATS MDM.OPT_OUT_CHK_LOAD_ID_IGN
  COLUMN LOG_SOURCE_ID;
  .IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;