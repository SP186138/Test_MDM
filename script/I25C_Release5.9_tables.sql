.logon 10.36.32.8/sysdba,nabez4pa;

CREATE SET GLOBAL TEMPORARY TABLE ICRM_STAGE_TBL.I25C_REGIS_PRSNA_OPT_HISTTEMP ,NO FALLBACK ,
     CHECKSUM = DEFAULT,
     DEFAULT MERGEBLOCKRATIO,
     LOG
     (
      REGIS_PRSNA_ID INTEGER NOT NULL,
      OPT_TYPE_CODE CHAR(2) CHARACTER SET LATIN NOT CASESPECIFIC NOT NULL,
      MKTNG_PGM_NBR INTEGER NOT NULL,
      LEGAL_ENT_NBR SMALLINT,
      DATA_SRCE_NBR SMALLINT,
      SUBSCRIPTION_NBR INTEGER,
      FIRST_NAME VARCHAR(100) CHARACTER SET UNICODE NOT CASESPECIFIC,
      LAST_NAME VARCHAR(100) CHARACTER SET UNICODE NOT CASESPECIFIC,
      EMAIL_ADDR_TEXT VARCHAR(50) CHARACTER SET UNICODE NOT CASESPECIFIC,
      CONTACT_PHONE_NBR VARCHAR(20) CHARACTER SET LATIN NOT CASESPECIFIC,
      SRC_ADDR_LINE_1_TXT VARCHAR(100) CHARACTER SET UNICODE NOT CASESPECIFIC,
      SRC_ADDR_LINE_2_TXT VARCHAR(100) CHARACTER SET UNICODE NOT CASESPECIFIC,
      SRC_ADDR_LINE_3_TXT VARCHAR(100) CHARACTER SET UNICODE NOT CASESPECIFIC,
      SRC_CITY_NAME VARCHAR(50) CHARACTER SET UNICODE NOT CASESPECIFIC,
      SRC_STATE VARCHAR(50) CHARACTER SET UNICODE NOT CASESPECIFIC,
      SRC_ZIP VARCHAR(20) CHARACTER SET UNICODE NOT CASESPECIFIC,
      SRC_CNTRY_NAME VARCHAR(50) CHARACTER SET UNICODE NOT CASESPECIFIC,
      ADDR_LINE_1_TXT VARCHAR(100) CHARACTER SET UNICODE NOT CASESPECIFIC,
      ADDR_LINE_2_TXT VARCHAR(100) CHARACTER SET UNICODE NOT CASESPECIFIC,
      ADDR_LINE_3_TXT VARCHAR(100) CHARACTER SET UNICODE NOT CASESPECIFIC,
      CITY_NAME VARCHAR(100) CHARACTER SET UNICODE NOT CASESPECIFIC,
      TERR_NAME VARCHAR(100) CHARACTER SET UNICODE NOT CASESPECIFIC,
      POSTL_AREA_CODE VARCHAR(20) CHARACTER SET UNICODE NOT CASESPECIFIC,
      CNTRY_NAME VARCHAR(100) CHARACTER SET UNICODE NOT CASESPECIFIC,
      OPT_IND VARCHAR(2) CHARACTER SET LATIN NOT CASESPECIFIC,
      OPT_TIME TIMESTAMP(0),
      OPT_REASN_TXT VARCHAR(100) CHARACTER SET UNICODE NOT CASESPECIFIC,
      LAST_ACTIVITY_TM TIMESTAMP(0),
      LOG_SOURCE_ID VARCHAR(25) CHARACTER SET LATIN NOT CASESPECIFIC,
      LOG_UPDATE_USER VARCHAR(20) CHARACTER SET LATIN NOT CASESPECIFIC,
      LOG_LOAD_ID VARCHAR(8) CHARACTER SET LATIN NOT CASESPECIFIC,
      PE_OPTOUT_ID BIGINT,
      NATIONAL_ID_NBR VARCHAR(20) CHARACTER SET LATIN NOT CASESPECIFIC,
      CHANNEL_IND VARCHAR(3) CHARACTER SET LATIN NOT CASESPECIFIC,
      OPT_LEVEL_IND CHAR(1) CHARACTER SET LATIN NOT CASESPECIFIC,
      POSTL_ADDR_ID INTEGER)
PRIMARY INDEX REGIS_PRSNA_OPT_NUPI ( REGIS_PRSNA_ID )
ON COMMIT PRESERVE ROWS;


CREATE MULTISET TABLE ICRM_STAGE_TBL.I25C_OPT_OUT_LOG_TEMP ,NO FALLBACK ,
     NO BEFORE JOURNAL,
     NO AFTER JOURNAL,
     CHECKSUM = DEFAULT,
     DEFAULT MERGEBLOCKRATIO
     (
      EDW_REGIS_PRSNA_ID INTEGER NOT NULL,
      EDW_OPT_TYPE_CODE CHAR(2) CHARACTER SET LATIN NOT CASESPECIFIC NOT NULL,
      EDW_MKTNG_PGM_NBR INTEGER NOT NULL,
      EDW_LEGAL_ENT_NBR INTEGER,
      EDW_DATA_SRCE_NBR INTEGER,
      EDW_SUBSCRIPTION_NBR INTEGER,
      EDW_CHANNEL_IND VARCHAR(3) CHARACTER SET LATIN NOT CASESPECIFIC,
      EDW_OPT_LEVEL_IND CHAR(1) CHARACTER SET LATIN NOT CASESPECIFIC,
      EDW_LOG_SOURCE_ID VARCHAR(25) CHARACTER SET LATIN NOT CASESPECIFIC,
      STG_REGIS_PRSNA_ID INTEGER NOT NULL,
      STG_OPT_TYPE_CODE CHAR(2) CHARACTER SET LATIN NOT CASESPECIFIC,
      STG_MKTNG_PGM_NBR INTEGER NOT NULL,
      STG_LEGAL_ENT_NBR INTEGER,
      STG_DATA_SRCE_NBR INTEGER,
      STG_SUBSCRIPTION_NBR INTEGER,
      STG_FIRST_NAME VARCHAR(100) CHARACTER SET UNICODE NOT CASESPECIFIC,
      STG_LAST_NAME VARCHAR(100) CHARACTER SET UNICODE NOT CASESPECIFIC,
      STG_EMAIL_ADDR_TEXT VARCHAR(50) CHARACTER SET UNICODE NOT CASESPECIFIC,
      STG_CONTACT_PHONE_NBR VARCHAR(20) CHARACTER SET LATIN NOT CASESPECIFIC,
      STG_SRC_ADDR_LINE_1_TXT VARCHAR(100) CHARACTER SET UNICODE NOT CASESPECIFIC,
      STG_SRC_ADDR_LINE_2_TXT VARCHAR(100) CHARACTER SET UNICODE NOT CASESPECIFIC,
      STG_SRC_ADDR_LINE_3_TXT VARCHAR(100) CHARACTER SET UNICODE NOT CASESPECIFIC,
      STG_SRC_CITY_NAME VARCHAR(50) CHARACTER SET UNICODE NOT CASESPECIFIC,
      STG_SRC_STATE VARCHAR(50) CHARACTER SET UNICODE NOT CASESPECIFIC,
      STG_SRC_ZIP VARCHAR(20) CHARACTER SET UNICODE NOT CASESPECIFIC,
      STG_SRC_CNTRY_NAME VARCHAR(50) CHARACTER SET UNICODE NOT CASESPECIFIC,
      STG_ADDR_LINE_1_TXT VARCHAR(100) CHARACTER SET UNICODE NOT CASESPECIFIC,
      STG_ADDR_LINE_2_TXT VARCHAR(100) CHARACTER SET UNICODE NOT CASESPECIFIC,
      STG_ADDR_LINE_3_TXT VARCHAR(100) CHARACTER SET UNICODE NOT CASESPECIFIC,
      STG_CITY_NAME VARCHAR(100) CHARACTER SET UNICODE NOT CASESPECIFIC,
      STG_TERR_NAME VARCHAR(100) CHARACTER SET UNICODE NOT CASESPECIFIC,
      STG_POSTL_AREA_CODE VARCHAR(20) CHARACTER SET UNICODE NOT CASESPECIFIC,
      STG_CNTRY_NAME VARCHAR(100) CHARACTER SET UNICODE NOT CASESPECIFIC,
      STG_TERR_CODE CHAR(8) CHARACTER SET UNICODE NOT CASESPECIFIC COMPRESS ,
      STG_CITY_CODE INTEGER COMPRESS ,
      STG_OPT_IND VARCHAR(2) CHARACTER SET LATIN NOT CASESPECIFIC,
      STG_OPT_TIME TIMESTAMP(0),
      STG_OPT_REASN_TXT VARCHAR(100) CHARACTER SET UNICODE NOT CASESPECIFIC,
      STG_LAST_ACTIVITY_TM TIMESTAMP(0),
      STG_LOG_SOURCE_ID VARCHAR(25) CHARACTER SET LATIN NOT CASESPECIFIC,
      STG_LOG_UPDATE_USER VARCHAR(20) CHARACTER SET LATIN NOT CASESPECIFIC,
      STG_LOG_LOAD_ID VARCHAR(8) CHARACTER SET LATIN NOT CASESPECIFIC,
      STG_PE_OPTOUT_ID BIGINT,
      STG_NATIONAL_ID_NBR VARCHAR(20) CHARACTER SET LATIN NOT CASESPECIFIC,
      STG_CHANNEL_IND VARCHAR(3) CHARACTER SET LATIN NOT CASESPECIFIC,
      STG_OPT_LEVEL_IND CHAR(1) CHARACTER SET LATIN NOT CASESPECIFIC,
      SYS_CREATE_DATE DATE FORMAT 'YYYY-MM-DD')
PRIMARY INDEX OPT_OUT_LIST_TEMP_NUPI ( STG_REGIS_PRSNA_ID ,STG_MKTNG_PGM_NBR ,
STG_OPT_TIME ,STG_LOG_SOURCE_ID );


CREATE MULTISET TABLE ICRM_STAGE_TBL.I25C_POSTL_OPT_OUT_I10_TEMP ,NO FALLBACK ,
     NO BEFORE JOURNAL,
     NO AFTER JOURNAL,
     CHECKSUM = DEFAULT,
     DEFAULT MERGEBLOCKRATIO
     (
      TRM_LEAD_KEY VARCHAR(20) CHARACTER SET LATIN NOT CASESPECIFIC,
      REGIS_PRSNA_ID INTEGER,
      SUBSCRPTN_OPT_NBR INTEGER,
      CNTCT_POINT_CATEG_CODE CHAR(2) CHARACTER SET LATIN NOT CASESPECIFIC NOT NULL,
      POSTL_DPLOYMT_DATE DATE FORMAT 'YYYY-MM-DD',
      LINK_WEB_URL VARCHAR(200) CHARACTER SET UNICODE NOT CASESPECIFIC,
      COMM_ID VARCHAR(20) CHARACTER SET LATIN NOT CASESPECIFIC,
      RUN_ID VARCHAR(20) CHARACTER SET LATIN NOT CASESPECIFIC,
      RESP_REC_TYPE_CODE CHAR(2) CHARACTER SET LATIN NOT CASESPECIFIC NOT NULL,
      RESP_DATETM TIMESTAMP(6),
      MAILING_ID VARCHAR(20) CHARACTER SET LATIN NOT CASESPECIFIC,
      WAVE_ID VARCHAR(20) CHARACTER SET LATIN NOT CASESPECIFIC,
      MKTNG_PGM_NBR INTEGER,
      S_ADD1 VARCHAR(100) CHARACTER SET UNICODE NOT CASESPECIFIC,
      S_ADD2 VARCHAR(100) CHARACTER SET UNICODE NOT CASESPECIFIC,
      S_ADD3 VARCHAR(100) CHARACTER SET UNICODE NOT CASESPECIFIC,
      S_STRET_NUM VARCHAR(20) CHARACTER SET UNICODE NOT CASESPECIFIC,
      S_STRET_NAME VARCHAR(100) CHARACTER SET UNICODE NOT CASESPECIFIC,
      S_APT_NUM VARCHAR(20) CHARACTER SET UNICODE NOT CASESPECIFIC,
      S_PO_BOX_NUM VARCHAR(20) CHARACTER SET UNICODE NOT CASESPECIFIC,
      S_CITY_NAME VARCHAR(100) CHARACTER SET UNICODE NOT CASESPECIFIC,
      S_POSTL_AREA_CODE VARCHAR(20) CHARACTER SET UNICODE NOT CASESPECIFIC,
      S_TERR_NAME VARCHAR(100) CHARACTER SET UNICODE NOT CASESPECIFIC,
      S_CNTRY_NAME VARCHAR(100) CHARACTER SET UNICODE NOT CASESPECIFIC,
      ADDR_LINE_1_TXT VARCHAR(100) CHARACTER SET LATIN NOT CASESPECIFIC,
      ADDR_LINE_2_TXT VARCHAR(100) CHARACTER SET LATIN NOT CASESPECIFIC,
      ADDR_LINE_3_TXT VARCHAR(100) CHARACTER SET LATIN NOT CASESPECIFIC,
      STRET_NUM VARCHAR(20) CHARACTER SET LATIN NOT CASESPECIFIC,
      STRET_NAME VARCHAR(100) CHARACTER SET LATIN NOT CASESPECIFIC,
      APT_NUM VARCHAR(20) CHARACTER SET LATIN NOT CASESPECIFIC,
      PO_BOX_NUM VARCHAR(20) CHARACTER SET LATIN NOT CASESPECIFIC,
      CITY_NAME VARCHAR(100) CHARACTER SET LATIN NOT CASESPECIFIC,
      POSTL_AREA_CODE VARCHAR(20) CHARACTER SET LATIN NOT CASESPECIFIC,
      TERR_NAME VARCHAR(100) CHARACTER SET LATIN NOT CASESPECIFIC,
      CNTRY_NAME VARCHAR(100) CHARACTER SET LATIN NOT CASESPECIFIC,
      POSTL_STATUS_CODE CHAR(2) CHARACTER SET LATIN NOT CASESPECIFIC,
      LOAD_ID DECIMAL(18,0),
      LOAD_TS TIMESTAMP(0),
      MDM_LOAD_IND CHAR(2) CHARACTER SET LATIN NOT CASESPECIFIC,
      REGIS_CNSMR_ID_VAL VARCHAR(100) CHARACTER SET LATIN NOT CASESPECIFIC,
      ICRM_STG_LOAD_ID DECIMAL(18,0))
PRIMARY INDEX ( REGIS_PRSNA_ID ,MKTNG_PGM_NBR )
PARTITION BY MKTNG_PGM_NBR ;