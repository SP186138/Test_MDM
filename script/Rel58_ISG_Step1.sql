.logon $TDPID/$TDUSER,$TDPWD

.SET ERROROUT STDOUT ;
 .IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;
.SET SESSION CHARSET 'UTF8' ;
 .IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;

.GOTO $Step

.LABEL L1
CREATE TABLE DEPLOY_WORK.ATTRIBUTE_VALUES_MDM_58_2 AS MDM.ATTRIBUTE_VALUES WITH DATA;
 .IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;
.LABEL L2
CREATE TABLE DEPLOY_WORK.ATTRIBUTE_TYPES_MDM_58_2 AS MDM.ATTRIBUTE_TYPES WITH DATA;
 .IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;
 .LABEL L3
CREATE TABLE DEPLOY_WORK.ATTRIBUTE_TYPES_HIERARCHY_MDM_58_2 AS MDM.ATTRIBUTE_TYPES_HIERARCHY WITH DATA;
.IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;
.LABEL L4
CREATE TABLE DEPLOY_WORK.ATTRIBUTE_TYPES_RELN_MDM_58_2 AS MDM.ATTRIBUTE_TYPES_RELN WITH DATA;
.IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;
.LABEL L5
CREATE TABLE DEPLOY_WORK.ATTRIBUTE_VALUES_HIERARCHY_MDM_58_2 AS MDM.ATTRIBUTE_VALUES_HIERARCHY WITH DATA;
.IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;
.LABEL L6
CREATE TABLE DEPLOY_WORK.ATTRIBUTE_VALUES_RELN_MDM_58_2 AS MDM.ATTRIBUTE_VALUES_RELN WITH DATA;
.IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;
.LABEL L7
CREATE TABLE DEPLOY_WORK.RPT_ADDR_QLTY_MDM_58_2 AS MDM.RPT_ADDR_QLTY WITH DATA;
.IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;
.LABEL L8
CREATE TABLE DEPLOY_WORK.RPT_CNSMR_NBR_MDM_58_2 AS MDM.RPT_CNSMR_NBR WITH DATA;
.IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;
.LABEL L9
CREATE TABLE DEPLOY_WORK.RPT_DATA_NBR_MDM_58_2 AS MDM.RPT_DATA_NBR WITH DATA;
.IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;
.LABEL L10
CREATE TABLE DEPLOY_WORK.RPT_LOAD_NBR_MDM_58_2 AS MDM.RPT_LOAD_NBR WITH DATA;
.IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;
.LABEL L11
DROP TABLE TRILLIUM_OUTPUT_DUP1;
.IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;
.LABEL L11A
CREATE MULTISET TABLE MDM.TRILLIUM_OUTPUT_DUP1 ,NO FALLBACK ,
     NO BEFORE JOURNAL,
     NO AFTER JOURNAL,
     CHECKSUM = DEFAULT,
     DEFAULT MERGEBLOCKRATIO
     (
      MKTNG_PGM_NBR INTEGER NOT NULL,
      REGIS_CNSMR_ID_VAL VARCHAR(1000) CHARACTER SET UNICODE NOT CASESPECIFIC NOT NULL,
      DR_ALIAS_CONTACT VARCHAR(30) CHARACTER SET UNICODE NOT CASESPECIFIC,
      DR_FIRST_NAME VARCHAR(30) CHARACTER SET UNICODE NOT CASESPECIFIC,
      DR_MIDDLE_NAME VARCHAR(30) CHARACTER SET UNICODE NOT CASESPECIFIC,
      DR_LAST_NAME VARCHAR(30) CHARACTER SET UNICODE NOT CASESPECIFIC,
      DR_NAME_GENER VARCHAR(15) CHARACTER SET UNICODE NOT CASESPECIFIC COMPRESS '',
      DR_NAME_SUFFIX VARCHAR(15) CHARACTER SET UNICODE NOT CASESPECIFIC COMPRESS '',
      DR_NAME_GENDER CHAR(1) CHARACTER SET UNICODE NOT CASESPECIFIC COMPRESS ('F','M','U'),
      DR_COUNTRY_NAME VARCHAR(20) CHARACTER SET UNICODE NOT CASESPECIFIC,
      DR_REGION_NAME VARCHAR(40) CHARACTER SET UNICODE NOT CASESPECIFIC,
      DR_CITY_NAME VARCHAR(30) CHARACTER SET UNICODE NOT CASESPECIFIC,
      DR_POSTAL_CODE VARCHAR(15) CHARACTER SET UNICODE NOT CASESPECIFIC COMPRESS '',
      DR_STREET_NAME VARCHAR(60) CHARACTER SET UNICODE NOT CASESPECIFIC COMPRESS '',
      DR_HOUSE_NUMBER1 VARCHAR(15) CHARACTER SET UNICODE NOT CASESPECIFIC,
      DR_HOUSE_NUMBER2 VARCHAR(15) CHARACTER SET UNICODE NOT CASESPECIFIC COMPRESS '',
      DR_POBOX_NUMBER VARCHAR(15) CHARACTER SET UNICODE NOT CASESPECIFIC COMPRESS ,
      DR_ADDRESS VARCHAR(150) CHARACTER SET UNICODE NOT CASESPECIFIC COMPRESS '',
      DR_ADDRESS2 VARCHAR(150) CHARACTER SET UNICODE NOT CASESPECIFIC COMPRESS '',
      DR_ADDRESS3 VARCHAR(150) CHARACTER SET UNICODE NOT CASESPECIFIC COMPRESS '',
      CLEANSED_PHONE_1 VARCHAR(30) CHARACTER SET UNICODE NOT CASESPECIFIC COMPRESS '',
      CLEANSED_EMAIL_1 VARCHAR(50) CHARACTER SET UNICODE NOT CASESPECIFIC COMPRESS '',
      PR_REV_GROUP VARCHAR(3) CHARACTER SET UNICODE NOT CASESPECIFIC COMPRESS ('000','010','','001','006','007','018','008','011','017','020','019','013','002','014'),
      GOUT_MATCH_LEVEL CHAR(1) CHARACTER SET UNICODE NOT CASESPECIFIC COMPRESS (' ','0','1','2','4','7','9'),
      WINDOW_KEY_01 VARCHAR(15) CHARACTER SET UNICODE NOT CASESPECIFIC NOT NULL,
      REFERENCE_HOUSEHOLD_ID VARCHAR(50) CHARACTER SET UNICODE NOT CASESPECIFIC COMPRESS ,
      REFERENCE_LEGALENTITYKEY VARCHAR(50) CHARACTER SET UNICODE NOT CASESPECIFIC COMPRESS ,
      REFERENCE_REGISTRATIONKEY VARCHAR(50) CHARACTER SET UNICODE NOT CASESPECIFIC,
      LEGAL_ENT_NBR INTEGER COMPRESS (1 ,2 ,3 ,4 ,5 ,6 ,8 ,10 ,11 ,12 ,13 ,14 ,15 ,16 ,17 ,18 ,19 ,20 ,21 ,22 ,23 ,25 ,26 ,28 ,34 ,35 ,37 ,38 ,39 ,40 ,41 ),
      BRTH_DATE DATE FORMAT 'yyyy-mm-dd' COMPRESS (DATE '1979-05-28',DATE '1986-09-28',DATE '1988-01-28',DATE '1970-09-28',DATE '1972-01-28',DATE '1985-12-01',DATE '1980-10-28',DATE '1982-02-28',DATE '1990-01-01',DATE '1976-03-28',DATE '1983-07-28',DATE '1982-10-01',DATE '1986-04-28',DATE '1977-08-28',DATE '1984-12-28',DATE '1985-07-01',DATE '1973-01-28',DATE '1980-05-28',DATE '1987-09-28',DATE '1989-01-28',DATE '1971-09-28',DATE '1986-12-01',DATE '1981-10-28',DATE '1983-02-28',DATE '1975-01-01',DATE '1982-05-01',DATE '1991-01-01',DATE '1977-03-28',DATE '1984-07-28',DATE '1983-10-01',DATE '1987-04-28',DATE '1978-08-28',DATE '1985-12-28',DATE '1986-07-01',DATE '1972-09-28',DATE '1974-01-28',DATE '1981-05-28',DATE '1990-01-28',DATE '1980-08-01',DATE '1975-06-28',DATE '1982-10-28',DATE '1984-02-28',DATE '1992-01-01',DATE '1976-01-01',DATE '1983-05-01',DATE '1978-03-28',DATE '1985-07-28',DATE '1984-10-01',DATE '1979-08-28',DATE '1953-02-20',DATE '1970-12-28',DATE '1987-07-01',DATE '1975-01-28',DATE '1982-05-28',DATE '1981-08-01',DATE '1976-06-28',DATE '1983-10-28',DATE '1985-02-28',DATE '1977-01-01',DATE '1984-05-01',DATE '1979-03-28',DATE '1986-07-28',DATE '1970-07-28',DATE '1977-11-28',DATE '1985-10-01',DATE '1980-08-28',DATE '1988-07-01',DATE '1974-09-28',DATE '1976-01-28',DATE '1983-05-28',DATE '1982-08-01',DATE '1986-02-28',DATE '1977-06-28',DATE '1984-10-28',DATE '1978-01-01',DATE '1985-05-01',DATE '1980-03-28',DATE '1987-07-28',DATE '1971-07-28',DATE '1978-11-28',DATE '1986-10-01',DATE '1981-08-28',DATE '1989-07-01',DATE '1975-09-28',DATE '1977-01-28',DATE '1984-05-28',DATE '1983-08-01',DATE '1978-06-28',DATE '1985-10-28',DATE '1979-01-01',DATE '1986-05-01',DATE '1979-11-28',DATE '1981-03-28',DATE '1980-06-01',DATE '1987-10-01',DATE '1982-08-28',DATE '1983-03-01',DATE '1976-09-28',DATE '1978-01-28',DATE '1985-05-28',DATE '1984-08-01',DATE '1979-06-28',DATE '1986-10-28',DATE '1900-01-01',DATE '1980-01-01',DATE '1987-05-01',DATE '1980-11-28',DATE '1982-03-28',DATE '1974-12-28',DATE '1983-08-28',DATE '1982-11-01',DATE '1984-03-01',DATE '1979-01-28',DATE '1986-05-28',DATE '1970-05-28',DATE '1977-09-28',DATE '1985-08-01',DATE '1980-06-28',DATE '1987-10-28',DATE '1901-01-01',DATE '1981-01-01',DATE '1988-05-01',DATE '1974-07-28',DATE '1981-11-28',DATE '1983-03-28',DATE '1982-06-01',DATE '1977-04-28',DATE '1984-08-28',DATE '1983-11-01',DATE '1985-03-01',DATE '1900-01-28',DATE '1980-01-28',DATE '1987-05-28',DATE '1978-09-28',DATE '1986-08-01',DATE '1972-10-28',DATE '1981-06-28',DATE '1980-09-01',DATE '1982-01-01',DATE '1975-07-28',DATE '1982-11-28',DATE '1984-03-28',DATE '1983-06-01',DATE '1976-12-28',DATE '1978-04-28',DATE '1985-08-28',DATE '1986-03-01',DATE '1984-11-01',DATE '1979-09-28',DATE '1981-01-28',DATE '1987-08-01',DATE '1982-06-28',DATE '1981-09-01',DATE '1983-01-01',DATE '1976-07-28',DATE '1983-11-28',DATE '1985-03-28',DATE '1984-06-01',DATE '1979-04-28',DATE '1986-08-28',DATE '1970-08-28',DATE '1977-12-28',DATE '1987-03-01',DATE '1985-11-01',DATE '1980-09-28',DATE '1982-01-28',DATE '1988-08-01',DATE '1974-10-28',DATE '1983-06-28',DATE '1982-09-01',DATE '1984-01-01',DATE '1986-03-28',DATE '1977-07-28',DATE '1984-11-28',DATE '1985-06-01',DATE '1980-04-28',DATE '1987-08-28',DATE '1978-12-28',DATE '1981-09-28',DATE '1983-01-28',DATE '1980-12-01',DATE '1989-08-01',DATE '1975-10-28',DATE '1977-02-28',DATE '1984-06-28',DATE '1983-09-01',DATE '1985-01-01',DATE '1987-03-28',DATE '1978-07-28',DATE '1985-11-28',DATE '1986-06-01',DATE '1979-12-28',DATE '1981-04-28',DATE '1980-07-01',DATE '1975-05-28',DATE '1982-09-28',DATE '1984-01-28',DATE '1976-10-28',DATE '1978-02-28',DATE '1985-06-28',DATE '1986-01-01',DATE '1970-01-01',DATE '1984-09-01',DATE '1979-07-28',DATE '1987-06-01',DATE '1980-12-28',DATE '1982-04-28',DATE '1981-07-01',DATE '1976-05-28',DATE '1983-09-28',DATE '1985-01-28',DATE '1982-12-01',DATE '1979-02-28',DATE '1986-06-28',DATE '1977-10-28',DATE '1987-01-01',DATE '1985-09-01',DATE '1980-07-28',DATE '1988-06-01',DATE '1974-08-28',DATE '1981-12-28',DATE '1983-04-28',DATE '1982-07-01',DATE '1986-01-28',DATE '1970-01-28',DATE '1977-05-28',DATE '1984-09-28',DATE '1983-12-01',DATE '1985-04-01',DATE '1980-02-28',DATE '1978-10-28',DATE '1986-09-01',DATE '1988-01-01',DATE '1981-07-28',DATE '1980-10-01',DATE '1975-08-28',DATE '1982-12-28',DATE '1984-04-28',DATE '1983-07-01',DATE '1987-01-28',DATE '1971-01-28',DATE '1978-05-28',DATE '1985-09-28',DATE '1979-10-28',DATE '1981-02-28',DATE '1980-05-01',DATE '1987-09-01',DATE '1989-01-01',DATE '1975-03-28',DATE '1982-07-28',DATE '1981-10-01',DATE '1976-08-28',DATE '1983-12-28',DATE '1985-04-28',DATE '1984-07-01'),
      LANG_CODE CHAR(5) CHARACTER SET UNICODE NOT CASESPECIFIC COMPRESS ('     ','DE   ','EN   ','ES   ','FR   ','IT   ','JA   ','PL   ','PT   ','RU   ','TR   ','TW   ','ZH   ','en_CA','en_US'),
      CNSMR_USER_NAME VARCHAR(100) CHARACTER SET UNICODE NOT CASESPECIFIC COMPRESS '',
      STATUS VARCHAR(20) CHARACTER SET UNICODE NOT CASESPECIFIC COMPRESS 'IN PROCESS',
      FULL_NAME VARCHAR(100) CHARACTER SET UNICODE NOT CASESPECIFIC COMPRESS '',
      DPEND_NAME VARCHAR(100) CHARACTER SET UNICODE NOT CASESPECIFIC COMPRESS '',
      PET_NAME VARCHAR(100) CHARACTER SET UNICODE NOT CASESPECIFIC COMPRESS '',
      PR_NAME_FORM_01 CHAR(1) CHARACTER SET UNICODE NOT CASESPECIFIC COMPRESS (' ','0','1'),
      DR_ALIAS_ACCOUNT VARCHAR(50) CHARACTER SET UNICODE NOT CASESPECIFIC COMPRESS '',
      REFERENCE_MATCHED_LEV1_PATTERN VARCHAR(3) CHARACTER SET UNICODE NOT CASESPECIFIC COMPRESS ('100','101','102','103','','050','242'),
      REFERENCE_MATCHED_LEV2_PATTERN VARCHAR(3) CHARACTER SET UNICODE NOT CASESPECIFIC COMPRESS ('100','204',''),
      DR_BUSINESS_NAME VARCHAR(50) CHARACTER SET UNICODE NOT CASESPECIFIC COMPRESS '',
      EMAIL_IND CHAR(1) CHARACTER SET UNICODE NOT CASESPECIFIC COMPRESS ('N','Y'),
      REGIS_DATE VARCHAR(20) CHARACTER SET LATIN NOT CASESPECIFIC NOT NULL COMPRESS ('2015-01-07 18:33:44','1900-01-01 00:00:00','2006-06-30 21:54:49','2014-11-06 04:57:26','2013-06-20 03:14:51.','2014-08-18 06:56:24','2011-06-29 00:00:00','2006-06-30 23:25:45','2012-12-19 00:00:00','2014-07-02 00:00:00','2011-06-30 00:00:00','2015-03-18 02:14:13','2011-06-21 04:28:29.','2013-09-07 00:00:00','2011-06-21 04:28:45.','2006-06-30 23:21:55','2010-12-21 03:14:08.','0001-01-01 00:00:00.','2012-12-15 00:00:00','2013-06-03 00:00:00','2010-06-21 03:54:26.','2012-12-12 00:00:00','2014-09-26 15:03:19','2014-09-26 15:03:21','2014-09-26 15:03:22','2014-09-26 15:03:18','2014-09-26 15:03:20','2014-01-01 00:00:00','2014-09-26 15:03:23','2013-04-19 00:00:00','2012-11-26 00:00:00','2013-03-12 00:00:00','2008-01-07 16:20:20','2014-09-26 15:03:17','2014-08-18 00:00:00','2013-04-17 00:00:00','2006-06-30 23:20:58','2013-08-16 00:00:00','2013-01-27 00:00:00','2012-12-10 00:00:00','2013-04-20 00:00:00','2014-05-28 08:00:16','2014-10-15 23:03:26','2013-05-13 00:00:00','2013-03-25 00:00:00','2012-06-07 00:00:00','2006-07-01 00:34:04','2012-12-28 00:00:00','2014-09-26 11:17:39','2013-04-01 00:00:00','2013-02-22 00:00:00','2013-02-28 00:00:00','2014-11-24 00:00:00','2013-04-22 00:00:00','2014-09-19 08:29:53','2014-09-19 08:29:57','2014-09-19 08:29:55','2014-09-19 08:29:52','2012-06-08 00:00:00','2013-05-20 00:00:00','2012-01-04 00:00:00','2012-07-09 00:00:00','2014-09-19 08:30:12','2014-09-19 08:30:05','2012-08-22 00:00:00','2014-09-26 04:21:29','2014-07-18 01:19:11','2014-02-27 00:00:00','2014-09-19 08:29:47','2012-09-03 00:00:00','2014-09-19 08:30:04','2014-05-02 00:00:00','2014-09-19 08:30:02','2012-07-17 00:00:00','2014-09-19 08:30:10','2014-09-19 08:30:03','2014-03-21 00:00:00','1998-09-24 00:00:00','2014-07-15 18:49:59','2014-09-19 08:30:06','2014-09-19 08:30:01','2014-10-27 00:00:00','2014-09-19 08:30:07','2014-09-19 08:29:51','2013-03-11 00:00:00','2014-06-23 00:00:00','2014-09-19 08:30:00','2013-10-09 00:00:00','2014-09-19 08:30:09','2012-08-10 00:00:00','2012-09-11 00:00:00','2013-05-21 00:00:00','2014-09-26 04:21:30','2013-03-07 00:00:00','2012-05-10 00:00:00','2014-09-19 08:29:50','2014-09-19 08:29:58','2014-12-29 00:00:00','2012-04-10 00:00:00','2014-09-26 04:21:28','2013-03-26 00:00:00','2012-07-03 00:00:00','2013-06-20 00:00:00','2014-01-17 03:30:32','2014-09-19 08:29:59','2013-04-03 00:00:00','2014-01-17 03:30:40','2013-05-14 00:00:00','2014-01-17 03:30:34','2015-01-19 00:00:00','2014-09-19 08:30:08','2014-01-17 03:30:31','2014-01-17 03:30:35','2014-06-05 00:00:00','2014-01-17 03:30:36','2014-01-17 03:30:33','2014-09-26 10:19:32','2014-01-17 03:30:37','2014-03-20 00:00:00','2014-01-17 03:30:39','2012-01-16 00:00:00','2013-11-13 00:00:00','2013-06-20 03:14:51','2014-12-08 00:00:00','2014-01-17 03:30:38','2014-09-19 08:30:11','2014-11-17 00:00:00','2015-01-05 00:00:00','2014-09-19 08:29:56','2014-09-19 08:29:48','2015-02-16 00:00:00','2013-04-11 00:00:00','2013-02-03 00:00:00','2014-09-26 15:03:24','2014-12-15 00:00:00','2014-09-19 08:29:54','2012-02-02 00:00:00','2015-02-13 22:17:22','2007-06-30 22:46:53','2013-01-07 00:00:00','2012-08-01 00:00:00','2015-01-12 00:00:00','2014-05-22 00:00:00','2013-06-18 00:00:00','2013-12-13 00:00:00','2014-06-15 00:00:00','2007-11-02 12:05:30','2012-08-16 00:00:00','2014-10-20 00:00:00','2013-06-05 00:00:00','2012-04-23 00:00:00','2012-03-01 00:00:00','2012-01-05 00:00:00','2014-11-03 00:00:00','2012-05-22 00:00:00','2013-05-22 00:00:00','2012-04-01 00:00:00','2012-02-16 00:00:00','2012-03-16 00:00:00','2012-11-19 00:00:00','2014-09-19 08:29:45','2012-07-23 00:00:00','2015-02-09 00:00:00','2012-03-08 00:00:00','2014-09-19 08:29:44','2014-06-02 00:00:00','2014-04-11 00:00:00','2014-12-01 00:00:00','2014-08-01 00:00:00','2014-09-19 08:29:49','2012-02-23 00:00:00','2012-09-22 00:00:00','2013-01-19 00:00:00','2009-12-21 03:22:14.','2014-04-08 00:00:00','2014-01-17 03:30:41','2014-09-19 08:29:46','2014-06-10 00:00:00','2015-01-26 00:00:00','2014-04-03 00:00:00','2014-03-13 00:00:00','2011-10-11 00:00:00','2014-03-27 00:00:00','2012-02-18 00:00:00.','2011-08-18 15:31:30.','2013-01-23 00:00:00','2012-03-22 00:00:00','1999-02-05 00:00:00','2014-06-13 00:00:00','2013-12-19 00:53:30','2014-11-03 14:18:52','2013-06-12 00:00:00','2014-09-26 11:15:09','2014-01-17 03:30:30','2014-03-25 00:00:00','2013-12-19 00:53:31','2013-08-04 21:59:33.','2010-01-27 00:00:00','2014-01-06 00:00:00','2009-07-04 00:00:00.','2014-09-19 08:29:42','2014-09-19 08:29:43','2013-06-22 00:00:00','1999-03-06 00:00:00','2013-12-19 00:53:29','2014-11-10 00:00:00','2014-12-22 00:00:00','2014-03-17 00:00:00','2011-08-09 15:04:10.','2013-12-19 00:53:34','2014-09-19 08:30:13','2014-09-19 08:29:39','2012-11-30 00:00:00','2014-09-26 11:24:23','2011-11-08 17:37:28.','2009-09-06 00:00:00.','2014-01-13 13:06:43','2015-02-02 00:00:00','2014-09-19 08:29:41','2013-01-21 00:00:00','2014-09-26 11:24:28','2014-06-12 00:00:00','2014-03-24 00:00:00','1999-01-01 00:00:00','2014-09-26 11:24:21','2012-12-27 00:00:00','2013-12-19 00:53:33','2007-11-02 12:05:07','2014-10-13 00:00:00','2014-09-26 10:19:33','2014-07-25 20:31:38','2012-05-04 00:00:00','2012-05-09 00:00:00','2013-09-06 19:33:04','2013-10-19 14:15:24.','2014-06-09 00:00:00','2014-03-14 00:00:00','2006-06-30 23:21:29','2013-06-26 00:00:00','2014-04-30 00:00:00','2008-12-03 12:00:00.','2009-08-15 00:00:00.','2014-09-26 11:24:22','2014-06-10 02:30:11','2014-05-19 00:00:00','2014-09-26 11:17:38','2013-12-19 00:53:32','2012-11-28 00:00:00','2013-12-19 00:53:28','2015-03-26 00:00:00','2013-02-25 00:00:00','2014-09-22 00:00:00','2011-12-12 00:00:00','2009-07-25 00:00:00.','2013-05-09 00:00:00'),
      RECORD_IND CHAR(3) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS 'Y  ',
      RECENT_IND CHAR(1) CHARACTER SET LATIN NOT CASESPECIFIC COMPRESS 'Y',
      DUP_REGIS_PRSNA_ID VARCHAR(50) CHARACTER SET UNICODE NOT CASESPECIFIC,
      SYS_TARGET_ID INTEGER COMPRESS (1280 ,1281 ,1029 ,1544 ,9993 ,1291 ,1293 ,1299 ,1307 ,1309 ,1061 ,1318 ,1327 ,1328 ,1075 ,1332 ,1333 ,1334 ,1335 ,1336 ,1339 ,1343 ,1346 ,1347 ,1092 ,1350 ,1100 ,1357 ,1358 ,1362 ,1363 ,1108 ,1109 ,1365 ,1366 ,1111 ,1112 ,1368 ,1113 ,1115 ,1376 ,7778 ,7779 ,1382 ,7782 ,7789 ,7790 ,1140 ,7796 ,7797 ,1142 ,1148 ,1149 ,1405 ,1150 ,1406 ,1152 ,1408 ,1153 ,1158 ,1419 ,1164 ,1167 ,1423 ,1424 ,7826 ,7827 ,7828 ,1179 ,7837 ,1182 ,1438 ,1439 ,1185 ,1441 ,1443 ,1188 ,1448 ,1197 ,1453 ,1455 ,1200 ,1457 ,1202 ,1459 ,1204 ,1460 ,1206 ,7865 ,1212 ,7868 ,1213 ,1471 ,1217 ,1222 ,1479 ,1224 ,7881 ,7882 ,1228 ,1484 ,1485 ,9933 ,1230 ,1231 ,1232 ,1233 ,1489 ,1490 ,1491 ,1492 ,1493 ,1239 ,1496 ,1241 ,1497 ,1242 ,1500 ,1501 ,1246 ,1502 ,1505 ,1251 ,1255 ,1001 ,1260 ,1279 ),
      SYS_AUTH_ID VARCHAR(25) CHARACTER SET UNICODE NOT CASESPECIFIC COMPRESS ,
      SYS_SOURCE VARCHAR(25) CHARACTER SET UNICODE NOT CASESPECIFIC DEFAULT 'BackEnd' COMPRESS ('             148534.','10954901','5978501','5978401','10518701','5976401','     245106','9653601','5978001','5978301','5976201','5977901','5977101','5979001','298891','5978101','5976601','5979101','358291','5976701','5979501','5977201','5978901','9751301','5979401','5977501','5976301','19533','5977001','5976801','5978201','5977301','5976501','5977401','5977701','5979201','298591','5979301','9572201','18233','5977801','10929201','11664401','5976901','14332701','11132601','11261601','7113','9686301','5977601','10753601','13133','5978601','6613','9751401','9638101','11450201','13833','13933','17260501','11450101','9560801','9638001','13617401','20791','5978701','9653701','10784701','10613','7367901','10913','9764701','10731201','11473001','10552601','11473101','11261701','14591','14033','26033','16030501','10496101','10823001','11317901','10404801','10404201','7213','9686401','10405201','10907601','10846601','15491','8191','10518801','10753401','7368001','10675601','4291','298691','10907501','26733','10405801','10955001','11473201','10395701','10395001','10404601','11450301','10396801','11152601','32691','10394801','10754301','9764801','10396101','114591','11317801','29691','11024701','10846701','10983601','11538101','10396001','11024601','14332001','10753901','11172601','12296701','10394901','     331706','10394601','10396901','10396401','10405901','10404501','10405001','10396501','10396201','15238001','5913','10404701','11237201','6313','12292301','15238901','11169601','5013','10396601','17791','298291','4572801','8033','15240601','11172701','10395901','10404401','11538001','10675501','10396701','10395801','10405701','10731301','343291','11613801','69091','7368101','11237101','60391','10626701','25533','4489201','114291','21091','12184101','10626501','52491','91591','13233','10405101','64891','10626901','5978801','10627001','38391','11024401','14331901','26533','10395601','9669201','20255501','10394701','14332201','4030001','14331701','265191','10952001','12712801','12594701','15240701','4313','11537101','358591','15239001','14331501','11613601','31691','9738601','18691','14332401','25933','10406101','10929301','     312606','12900901','19891','4302001','12295901','12754501','11207001','4060001','9638201','11821501','18791','16591','10626801','10396301','12594601','10626101','15988601','12754201','4048301','11236801','10405301','10784801','10823101','10626001','6513','34091','8013','4194801','4190501','10675701','14091','6691','20254801','12833901','10983701','12756201','64391','12754401','32391','10983401','28491','11280401','9686201'),
      SYS_CREATED_BY VARCHAR(70) CHARACTER SET UNICODE NOT CASESPECIFIC COMPRESS ,
      SYS_CREATION_DATE TIMESTAMP(0),
      SYS_ENT_STATE VARCHAR(25) CHARACTER SET UNICODE NOT CASESPECIFIC CHECK ( SYS_ENT_STATE  IN ('ACTIVE','INACTIVE','NEW','DELETED') ) COMPRESS ,
      SYS_LAST_MODIFIED_BY VARCHAR(70) CHARACTER SET UNICODE NOT CASESPECIFIC COMPRESS ,
      SYS_LAST_MODIFIED_DATE TIMESTAMP(0) COMPRESS ,
      SYS_NC_TYPE VARCHAR(25) CHARACTER SET UNICODE NOT CASESPECIFIC COMPRESS ('UPDATE','INSERT'),
      SYS_ERR_CODE VARCHAR(10000) CHARACTER SET UNICODE NOT CASESPECIFIC COMPRESS ,
      SYS_ERR_SVRTY VARCHAR(30) CHARACTER SET UNICODE NOT CASESPECIFIC CHECK ( SYS_ERR_SVRTY  IN ('SEVERE_ERROR','ERROR','WARNING') ) COMPRESS ,
      DR_MRMRS VARCHAR(40) CHARACTER SET UNICODE NOT CASESPECIFIC COMPRESS )
PRIMARY INDEX ( MKTNG_PGM_NBR ,REGIS_CNSMR_ID_VAL );

.IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;
.LABEL L11B

REPLACE VIEW MDM.TRILLIUM_OUTPUT_DUP (                                                 
  MKTNG_PGM_NBR                                                                    
 ,REGIS_CNSMR_ID_VAL                                                               
 ,DR_ALIAS_CONTACT                                                                 
 ,DR_FIRST_NAME                                                                    
 ,DR_MIDDLE_NAME                                                                   
 ,DR_LAST_NAME                                                                     
 ,DR_MRMRS                                                                         
 ,DR_NAME_GENER                                                                    
 ,DR_NAME_SUFFIX                                                                   
 ,DR_NAME_GENDER                                                                   
 ,DR_COUNTRY_NAME                                                                  
 ,DR_REGION_NAME                                                                   
 ,DR_CITY_NAME                                                                     
 ,DR_POSTAL_CODE                                                                   
 ,DR_STREET_NAME                                                                   
 ,DR_HOUSE_NUMBER1                                                                 
 ,DR_HOUSE_NUMBER2                                                                 
 ,DR_POBOX_NUMBER                                                                  
 ,DR_ADDRESS                                                                       
 ,DR_ADDRESS2                                                                      
 ,DR_ADDRESS3                                                                      
 ,CLEANSED_PHONE_1                                                                 
 ,CLEANSED_EMAIL_1                                                                 
 ,PR_REV_GROUP                                                                     
 ,GOUT_MATCH_LEVEL                                                                 
 ,WINDOW_KEY_01                                                                    
 ,REFERENCE_HOUSEHOLD_ID                                                           
 ,REFERENCE_LEGALENTITYKEY                                                         
 ,REFERENCE_REGISTRATIONKEY                                                        
 ,LEGAL_ENT_NBR                                                                    
 ,BRTH_DATE                                                                        
 ,LANG_CODE                                                                        
 ,CNSMR_USER_NAME                                                                  
 ,STATUS                                                                           
 ,FULL_NAME                                                                        
 ,DPEND_NAME                                                                       
 ,PET_NAME                                                                         
 ,PR_NAME_FORM_01                                                                  
 ,DR_ALIAS_ACCOUNT                                                                 
 ,REFERENCE_MATCHED_LEV1_PATTERN                                                   
 ,REFERENCE_MATCHED_LEV2_PATTERN                                                   
 ,DR_BUSINESS_NAME                                                                 
 ,EMAIL_IND          
 ,REGIS_DATE   
 ,RECORD_IND   
 ,RECENT_IND   
  ,DUP_REGIS_PRSNA_ID   
 ,SYS_TARGET_ID                                                                    
 ,SYS_AUTH_ID                                                                      
 ,SYS_SOURCE                                                                       
 ,SYS_CREATED_BY                                                                   
 ,SYS_CREATION_DATE                                                                
 ,SYS_ENT_STATE                                                                    
 ,SYS_LAST_MODIFIED_BY                                                             
 ,SYS_LAST_MODIFIED_DATE                                                           
 ,SYS_NC_TYPE                                                                      
 ,SYS_ERR_CODE                                                                     
 ,SYS_ERR_SVRTY                                                                    
) AS LOCKING ROW FOR ACCESS SELECT                                                 
  MKTNG_PGM_NBR                                                                    
 ,REGIS_CNSMR_ID_VAL                                                               
 ,DR_ALIAS_CONTACT                                                                 
 ,DR_FIRST_NAME                                                                    
 ,DR_MIDDLE_NAME                                                                   
 ,DR_LAST_NAME                                                                     
 ,DR_MRMRS                                                                         
 ,DR_NAME_GENER                                                                    
 ,DR_NAME_SUFFIX                                                                   
 ,DR_NAME_GENDER                                                                   
 ,DR_COUNTRY_NAME                                                                  
 ,DR_REGION_NAME                                                                   
 ,DR_CITY_NAME                                                                     
 ,DR_POSTAL_CODE                                                                   
 ,DR_STREET_NAME                                                                   
 ,DR_HOUSE_NUMBER1                                                                 
 ,DR_HOUSE_NUMBER2                                                                 
 ,DR_POBOX_NUMBER                                                                  
 ,DR_ADDRESS                                                                       
 ,DR_ADDRESS2                                                                      
 ,DR_ADDRESS3                                                                      
 ,CLEANSED_PHONE_1                                                                 
 ,CLEANSED_EMAIL_1                                                                 
 ,PR_REV_GROUP                                                                     
 ,GOUT_MATCH_LEVEL                                                                 
 ,WINDOW_KEY_01                                                                    
 ,REFERENCE_HOUSEHOLD_ID                                                           
 ,REFERENCE_LEGALENTITYKEY                                                         
 ,REFERENCE_REGISTRATIONKEY                                                        
 ,LEGAL_ENT_NBR                                                                    
 ,BRTH_DATE                                                                        
 ,LANG_CODE                                                                        
 ,CNSMR_USER_NAME                                                                  
 ,STATUS                                                                           
 ,FULL_NAME                                                                        
 ,DPEND_NAME                                                                       
 ,PET_NAME                                                                         
 ,PR_NAME_FORM_01                                                                  
 ,DR_ALIAS_ACCOUNT                                                                 
 ,REFERENCE_MATCHED_LEV1_PATTERN                                                   
 ,REFERENCE_MATCHED_LEV2_PATTERN                                                   
 ,DR_BUSINESS_NAME                                                                 
 ,EMAIL_IND        
 ,REGIS_DATE   
 ,RECORD_IND   
 ,RECENT_IND    
 ,DUP_REGIS_PRSNA_ID   
 ,SYS_TARGET_ID                                                                    
 ,SYS_AUTH_ID                                                                      
 ,SYS_SOURCE                                                                       
 ,SYS_CREATED_BY                                                                   
 ,SYS_CREATION_DATE                                                                
 ,SYS_ENT_STATE                                                                    
 ,SYS_LAST_MODIFIED_BY                                                             
 ,SYS_LAST_MODIFIED_DATE                                                           
 ,SYS_NC_TYPE                                                                      
 ,SYS_ERR_CODE                                                                     
 ,SYS_ERR_SVRTY                                                                    
FROM MDM.TRILLIUM_OUTPUT_DUP1;

.IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;
.LABEL L12
CREATE TABLE DEPLOY_WORK.tss_cntry_table_map_MDM_58_2 AS MDM.tss_cntry_table_map WITH DATA;
.IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;
.LABEL L13
CREATE TABLE DEPLOY_WORK.ENV_NM_MDM_58_2 AS MDM.ENV_NM WITH DATA;
.IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;
.LABEL L14
CREATE SET TABLE DEPLOY_WORK.ERR_PRSNA_STG ,NO FALLBACK ,
     NO BEFORE JOURNAL,
     NO AFTER JOURNAL,
     CHECKSUM = DEFAULT,
     DEFAULT MERGEBLOCKRATIO
     (
      MKTNG_PGM_NBR INTEGER,
      REGIS_CNSMR_ID_VAL VARCHAR(1000) CHARACTER SET LATIN NOT CASESPECIFIC,
      USER_NAME VARCHAR(100) CHARACTER SET UNICODE NOT CASESPECIFIC,
      PRSNA_REG_DT TIMESTAMP(0),
      GVN_NAME VARCHAR(100) CHARACTER SET UNICODE NOT CASESPECIFIC,
      MID_NAME VARCHAR(100) CHARACTER SET UNICODE NOT CASESPECIFIC,
      FAMLY_NAME VARCHAR(100) CHARACTER SET UNICODE NOT CASESPECIFIC,
      NAME_SUFFX_TXT CHAR(5) CHARACTER SET UNICODE NOT CASESPECIFIC,
      FULL_NAME VARCHAR(100) CHARACTER SET UNICODE NOT CASESPECIFIC,
      GENDR_IND CHAR(1) CHARACTER SET UNICODE NOT CASESPECIFIC,
      BRTH_DATE DATE FORMAT 'YY/MM/DD',
      LANG_CODE CHAR(5) CHARACTER SET UNICODE NOT CASESPECIFIC,
      PRSNA_STTUS_CODE CHAR(2) CHARACTER SET UNICODE NOT CASESPECIFIC,
      RECORD_IND CHAR(1) CHARACTER SET UNICODE NOT CASESPECIFIC,
      LOAD_ID DECIMAL(18,0),
      LOAD_TS TIMESTAMP(0),
      MDM_LOAD_IND CHAR(2) CHARACTER SET UNICODE NOT CASESPECIFIC,
      WIN_KEY VARCHAR(100) CHARACTER SET UNICODE NOT CASESPECIFIC,
      SYNC_STATUS VARCHAR(15) CHARACTER SET UNICODE NOT CASESPECIFIC,
      CNTRY_CODE CHAR(5) CHARACTER SET UNICODE NOT CASESPECIFIC,
      SYS_TARGET_ID INTEGER,
      SYS_AUTH_ID VARCHAR(25) CHARACTER SET UNICODE NOT CASESPECIFIC,
      SYS_SOURCE VARCHAR(25) CHARACTER SET UNICODE NOT CASESPECIFIC DEFAULT 'BackEnd',
      SYS_ERROR_ID INTEGER NOT NULL GENERATED BY DEFAULT AS IDENTITY
           (START WITH 1 
            INCREMENT BY 2 
            MINVALUE 1 
            MAXVALUE 2147483647 
            NO CYCLE),
      SYS_ERROR_TIME TIMESTAMP(0),
      SYS_ERR_SVRTY VARCHAR(30) CHARACTER SET UNICODE NOT CASESPECIFIC CHECK ( SYS_ERR_SVRTY  IN ('SEVERE_ERROR','ERROR','WARNING') ),
      SYS_NC_TYPE VARCHAR(25) CHARACTER SET UNICODE NOT CASESPECIFIC,
      SYS_DOCUMENT VARCHAR(100) CHARACTER SET UNICODE NOT CASESPECIFIC DEFAULT 'PRSNA_STG',
      SYS_LOAD_ID VARCHAR(32) CHARACTER SET UNICODE NOT CASESPECIFIC,
      SYS_WORKFLOW_ID VARCHAR(100) CHARACTER SET UNICODE NOT CASESPECIFIC,
      SYS_ERR_CODE VARCHAR(100) CHARACTER SET UNICODE NOT CASESPECIFIC,
      LYLTY_ACCT_NUM VARCHAR(100) CHARACTER SET LATIN NOT CASESPECIFIC,
      LYLTY_PGM_NBR SMALLINT,
      NAME_PREFX_TXT VARCHAR(40) CHARACTER SET UNICODE NOT CASESPECIFIC)
PRIMARY INDEX ( MKTNG_PGM_NBR ,REGIS_CNSMR_ID_VAL ) ;

.IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;

.LABEL L15
INSERT INTO DEPLOY_WORK.ERR_PRSNA_STG 
SEL * FROM MDM.ERR_PRSNA_STG;

.IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;

.LABEL L16
RENAME TABLE MDM.ERR_PRSNA_STG TO ERR_PRSNA_STG_BKUP_58_2;
.IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;
.LABEL L17
CREATE TABLE DEPLOY_WORK.upld_tmplt_prps_MDM_58_2 AS MDM.upld_tmplt_prps WITH DATA;
.IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;

.LABEL L18
CREATE TABLE DEPLOY_WORK.DQRM_Email_58_2 AS MDM.DQRM_Email WITH DATA;
.IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;

.LABEL L19
CREATE TABLE DEPLOY_WORK.DATA_SRCE_SUBS_OPT_IN_DMY_58_2 AS MDM.DATA_SRCE_SUBS_OPT_IN_DMY WITH DATA;
.IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;
.LABEL L20
CREATE TABLE DEPLOY_WORK.DATA_SRCE_SUBS_OPT_IN_58_2 AS MDM.DATA_SRCE_SUBS_OPT_IN WITH DATA;
.IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;
.LABEL L21
CREATE TABLE DEPLOY_WORK.TRT_IN_DUMMY_58_2 AS MDM.TRT_IN_DUMMY WITH DATA;
.IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;
.LABEL L22
CREATE TABLE DEPLOY_WORK.TRT_IN_58_2 AS MDM.TRT_IN WITH DATA;
.IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;
.LABEL L23
CREATE TABLE DEPLOY_WORK.PREDFND_TRT_VAL_IN_58_2 AS MDM.PREDFND_TRT_VAL_IN WITH DATA;
.IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;
.LABEL L24
CREATE TABLE DEPLOY_WORK.PREDFND_TRT_VAL_IN_DUMMY_58_2 AS MDM.PREDFND_TRT_VAL_IN_DUMMY WITH DATA;
.IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;

.LABEL L25
CREATE TABLE DEPLOY_WORK.WS_CNSMR_DEL_58_2 AS MDM.WS_CNSMR_DEL WITH DATA;
.IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;

.LABEL L26
CREATE TABLE DEPLOY_WORK.MST_REFERENCE_DESCRIPTION_58_2 AS MDM.MST_REFERENCE_DESCRIPTION WITH DATA;
.IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;

.LABEL L27
CREATE TABLE DEPLOY_WORK.MST_REFERENCE_CODE_58_2 AS MDM.MST_REFERENCE_CODE WITH DATA;
.IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;

.LABEL L28
CREATE TABLE DEPLOY_WORK.MST_CODE_SET_58_2 AS MDM.MST_CODE_SET WITH DATA;
.IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;

.LABEL L29
RENAME TABLE MDM.WS_CNSMR_DEL TO WS_CNSMR_DEL_BKUP_58_2;
.IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;