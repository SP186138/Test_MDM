/***********************************************************************************************************
SCRIPT:               VAL_BATCH_CLEANUP.BTEQ 
DESCRIPTION:          This script validates the records received from ETL Staging.
DEPENDENCY:           
INPUT:                ETL Staging
OUTPUT:               MST Staging
ERRORS:
SPECIAL INSTRUCTIONS:

CHANGE LOG:
VERSION              DATE                 AUTHOR                          CHANGES
1.00                 01/21/2011           TERADATA                        INITIAL VERSION
2.00                 08/22/2011           TERADATA                        Change OF Failure-BadFile
3.00                 10/31/2011           TERADATA                        Removal of Deletes as  part of ||elism
4.00                 03/26/2012		  TERADATA                        Made change in insert to LOAD_INFO to
                                                                          manipulate LA data
5.00                 07/08/2016	         TERADATA	Made change to insert the load id in the VALIDATION_LOAD_ID                	PRB0041660																		  
***********************************************************************************************************/

.logon $TDPID/$TDUSER,$TDPWD
 
.SET ERROROUT STDOUT;
.SET SESSION CHARSET 'UTF8';
.SET ERRORLEVEL 3624 SEVERITY 0
.SET ERRORLEVEL 3807 SEVERITY 0



COLLECT STATS ON  MDM.DPEND_STG
 COLUMN(MKTNG_PGM_NBR ,REGIS_CNSMR_ID_VAL ,SYS_SOURCE);
COLLECT STATS ON  MDM.PET_STG
 COLUMN(MKTNG_PGM_NBR ,REGIS_CNSMR_ID_VAL ,SYS_SOURCE);
COLLECT STATS ON  MDM.PRSNA_EMAIL_ADDR_STG
 COLUMN(MKTNG_PGM_NBR ,REGIS_CNSMR_ID_VAL ,SYS_SOURCE);
COLLECT STATS ON  MDM.PRSNA_PHONE_STG
 COLUMN(MKTNG_PGM_NBR ,REGIS_CNSMR_ID_VAL ,SYS_SOURCE);
COLLECT STATS ON  MDM.PRSNA_POSTL_ADDR_STG
 COLUMN(MKTNG_PGM_NBR ,REGIS_CNSMR_ID_VAL ,SYS_SOURCE);
COLLECT STATS ON  MDM.PRSNA_SOC_NETWK_ACCT_STG
 COLUMN(MKTNG_PGM_NBR ,REGIS_CNSMR_ID_VAL ,SYS_SOURCE);
COLLECT STATS ON  MDM.PRSNA_STG
 COLUMN(MKTNG_PGM_NBR ,REGIS_CNSMR_ID_VAL ,SYS_SOURCE);
COLLECT STATS ON  MDM.DPEND_TRT_STG
 COLUMN(MKTNG_PGM_NBR ,REGIS_CNSMR_ID_VAL ,SYS_SOURCE);
COLLECT STATS ON  MDM.PET_TRT_STG
 COLUMN(MKTNG_PGM_NBR ,REGIS_CNSMR_ID_VAL ,SYS_SOURCE);
COLLECT STATS ON  MDM.PRSNA_TRT_STG
 COLUMN(MKTNG_PGM_NBR ,REGIS_CNSMR_ID_VAL ,SYS_SOURCE);
COLLECT STATS ON  MDM.CNSMR_AFFLTN_STG
 COLUMN(MKTNG_PGM_NBR ,REGIS_CNSMR_ID_VAL ,SYS_SOURCE);
.IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE

DEL FROM VALIDATION_LOAD_ID;

.IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE

INSERT INTO VALIDATION_LOAD_ID
SEL * FROM VALIDATION_96641;

.IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE

DROP TABLE VALIDATION_ERR_96641;
.IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE
DROP TABLE VALIDATION_96641;
.IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE



.exit
