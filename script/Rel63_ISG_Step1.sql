.logon $TDPID/$TDUSER,$TDPWD
.SET ERRORLEVEL (3807) SEVERITY 0;
.SET ERROROUT STDOUT ;
 .IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;
.SET SESSION CHARSET 'UTF8' ;
 .IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;

.GOTO $Step

.LABEL L1
CREATE TABLE DEPLOY_WORK.ATTRIBUTE_VALUES_MDM_64 AS MDM.ATTRIBUTE_VALUES WITH DATA;
 .IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;
.LABEL L2
CREATE TABLE DEPLOY_WORK.ATTRIBUTE_TYPES_MDM_64 AS MDM.ATTRIBUTE_TYPES WITH DATA;
 .IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;
 .LABEL L3
CREATE TABLE DEPLOY_WORK.ATTRIBUTE_TYPES_HIERARCHY_MDM_64 AS MDM.ATTRIBUTE_TYPES_HIERARCHY WITH DATA;
.IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;
.LABEL L4
CREATE TABLE DEPLOY_WORK.ATTRIBUTE_TYPES_RELN_MDM_64 AS MDM.ATTRIBUTE_TYPES_RELN WITH DATA;
.IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;
.LABEL L5
CREATE TABLE DEPLOY_WORK.ATTRIBUTE_VALUES_HIERARCHY_MDM_64 AS MDM.ATTRIBUTE_VALUES_HIERARCHY WITH DATA;
.IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;
.LABEL L6
CREATE TABLE DEPLOY_WORK.ATTRIBUTE_VALUES_RELN_MDM_64 AS MDM.ATTRIBUTE_VALUES_RELN WITH DATA;
.IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;
.LABEL L7
CREATE TABLE DEPLOY_WORK.RPT_ADDR_QLTY_MDM_64 AS MDM.RPT_ADDR_QLTY WITH DATA;
.IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;
.LABEL L8
CREATE TABLE DEPLOY_WORK.RPT_CNSMR_NBR_MDM_64 AS MDM.RPT_CNSMR_NBR WITH DATA;
.IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;
.LABEL L9
CREATE TABLE DEPLOY_WORK.RPT_DATA_NBR_MDM_64 AS MDM.RPT_DATA_NBR WITH DATA;
.IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;
.LABEL L10
CREATE TABLE DEPLOY_WORK.RPT_LOAD_NBR_MDM_64 AS MDM.RPT_LOAD_NBR WITH DATA;
.IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;
.LABEL L11
CREATE TABLE MDM.TRILLIUM_OUTPUT_DUP_MDM_64 AS MDM.TRILLIUM_OUTPUT_DUP1 WITH DATA;
.IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;
.LABEL L12
CREATE TABLE DEPLOY_WORK.tss_cntry_table_map_MDM_64 AS MDM.tss_cntry_table_map WITH DATA;
.IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;
.LABEL L13
CREATE TABLE DEPLOY_WORK.ENV_NM_MDM_64 AS MDM.ENV_NM WITH DATA;
.IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;
.LABEL L14
DROP TABLE DEPLOY_WORK.ERR_PRSNA_STG;
.IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;
.LABEL L15
CREATE SET TABLE DEPLOY_WORK.ERR_PRSNA_STG ,NO FALLBACK ,
     NO BEFORE JOURNAL,
     NO AFTER JOURNAL,
     CHECKSUM = DEFAULT,
     DEFAULT MERGEBLOCKRATIO
     (
      MKTNG_PGM_NBR INTEGER,
      REGIS_CNSMR_ID_VAL VARCHAR(1000) CHARACTER SET LATIN NOT CASESPECIFIC,
      USER_NAME VARCHAR(100) CHARACTER SET UNICODE NOT CASESPECIFIC,
      PRSNA_REG_DT TIMESTAMP(0),
      GVN_NAME VARCHAR(100) CHARACTER SET UNICODE NOT CASESPECIFIC,
      MID_NAME VARCHAR(100) CHARACTER SET UNICODE NOT CASESPECIFIC,
      FAMLY_NAME VARCHAR(100) CHARACTER SET UNICODE NOT CASESPECIFIC,
      NAME_SUFFX_TXT CHAR(5) CHARACTER SET UNICODE NOT CASESPECIFIC,
      FULL_NAME VARCHAR(100) CHARACTER SET UNICODE NOT CASESPECIFIC,
      GENDR_IND CHAR(1) CHARACTER SET UNICODE NOT CASESPECIFIC,
      BRTH_DATE DATE FORMAT 'YY/MM/DD',
      LANG_CODE CHAR(5) CHARACTER SET UNICODE NOT CASESPECIFIC,
      PRSNA_STTUS_CODE CHAR(2) CHARACTER SET UNICODE NOT CASESPECIFIC,
      RECORD_IND CHAR(1) CHARACTER SET UNICODE NOT CASESPECIFIC,
      LOAD_ID DECIMAL(18,0),
      LOAD_TS TIMESTAMP(0),
      MDM_LOAD_IND CHAR(2) CHARACTER SET UNICODE NOT CASESPECIFIC,
      WIN_KEY VARCHAR(100) CHARACTER SET UNICODE NOT CASESPECIFIC,
      SYNC_STATUS VARCHAR(15) CHARACTER SET UNICODE NOT CASESPECIFIC,
      CNTRY_CODE CHAR(5) CHARACTER SET UNICODE NOT CASESPECIFIC,
      SYS_TARGET_ID INTEGER,
      SYS_AUTH_ID VARCHAR(25) CHARACTER SET UNICODE NOT CASESPECIFIC,
      SYS_SOURCE VARCHAR(25) CHARACTER SET UNICODE NOT CASESPECIFIC DEFAULT 'BackEnd',
      SYS_ERROR_ID INTEGER NOT NULL GENERATED BY DEFAULT AS IDENTITY
           (START WITH 1 
            INCREMENT BY 2 
            MINVALUE 1 
            MAXVALUE 2147483647 
            NO CYCLE),
      SYS_ERROR_TIME TIMESTAMP(0),
      SYS_ERR_SVRTY VARCHAR(30) CHARACTER SET UNICODE NOT CASESPECIFIC CHECK ( SYS_ERR_SVRTY  IN ('SEVERE_ERROR','ERROR','WARNING') ),
      SYS_NC_TYPE VARCHAR(25) CHARACTER SET UNICODE NOT CASESPECIFIC,
      SYS_DOCUMENT VARCHAR(100) CHARACTER SET UNICODE NOT CASESPECIFIC DEFAULT 'PRSNA_STG',
      SYS_LOAD_ID VARCHAR(32) CHARACTER SET UNICODE NOT CASESPECIFIC,
      SYS_WORKFLOW_ID VARCHAR(100) CHARACTER SET UNICODE NOT CASESPECIFIC,
      SYS_ERR_CODE VARCHAR(100) CHARACTER SET UNICODE NOT CASESPECIFIC,
      LYLTY_ACCT_NUM VARCHAR(100) CHARACTER SET LATIN NOT CASESPECIFIC,
      LYLTY_PGM_NBR SMALLINT,
      NAME_PREFX_TXT VARCHAR(40) CHARACTER SET UNICODE NOT CASESPECIFIC)
PRIMARY INDEX ( MKTNG_PGM_NBR ,REGIS_CNSMR_ID_VAL ) ;

.IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;

.LABEL L16
INSERT INTO DEPLOY_WORK.ERR_PRSNA_STG 
SEL * FROM MDM.ERR_PRSNA_STG;

.IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;

.LABEL L17
RENAME TABLE MDM.ERR_PRSNA_STG TO ERR_PRSNA_STG_BKUP_64;
.IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;
.LABEL L18
CREATE TABLE DEPLOY_WORK.upld_tmplt_prps_MDM_64 AS MDM.upld_tmplt_prps WITH DATA;
.IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;

.LABEL L19
CREATE TABLE DEPLOY_WORK.DQRM_Email_64 AS MDM.DQRM_Email WITH DATA;
.IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;

.LABEL L20
CREATE TABLE DEPLOY_WORK.DATA_SRCE_SUBS_OPT_IN_DMY_64 AS MDM.DATA_SRCE_SUBS_OPT_IN_DMY WITH DATA;
.IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;
.LABEL L21
CREATE TABLE DEPLOY_WORK.DATA_SRCE_SUBS_OPT_IN_64 AS MDM.DATA_SRCE_SUBS_OPT_IN WITH DATA;
.IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;
.LABEL L22
CREATE TABLE DEPLOY_WORK.TRT_IN_DUMMY_64 AS MDM.TRT_IN_DUMMY WITH DATA;
.IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;
.LABEL L23
CREATE TABLE DEPLOY_WORK.TRT_IN_64 AS MDM.TRT_IN WITH DATA;
.IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;
.LABEL L24
CREATE TABLE DEPLOY_WORK.PREDFND_TRT_VAL_IN_64 AS MDM.PREDFND_TRT_VAL_IN WITH DATA;
.IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;
.LABEL L25
CREATE TABLE DEPLOY_WORK.PREDFND_TRT_VAL_IN_DUMMY_64 AS MDM.PREDFND_TRT_VAL_IN_DUMMY WITH DATA;
.IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;

.LABEL L26
CREATE TABLE DEPLOY_WORK.WS_CNSMR_DEL_64 AS MDM.WS_CNSMR_DEL WITH DATA;
.IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;

.LABEL L27
CREATE TABLE DEPLOY_WORK.WS_CNSMR_GDPR_RQST_64 AS MDM.WS_CNSMR_GDPR_RQST WITH DATA;
.IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;

.LABEL L28
CREATE TABLE DEPLOY_WORK.GDPR_HANDLER_64 AS MDM.GDPR_HANDLER WITH DATA;
.IF ERRORLEVEL > 0 THEN .QUIT ERRORCODE;







