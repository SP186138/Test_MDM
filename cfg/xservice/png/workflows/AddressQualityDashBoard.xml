<?xml version="1.0" encoding="UTF-8"?>
<workflow mgcCount="3" ShowInBreadCrumbs="true" Version="1.0" Name="AddressQualityDashBoard" Description="" Type="" PrimaryDocument="" IsStartAllowed="Yes">
  <variables Name="AddressQualityDashBoard">
    <variable Name="matchedDomainValues" Type="xml" Comment=""/>
    <variable Name="programIDValues" Type="xml" Comment=""/>
    <variable Name="searchResults" Type="xml" Comment=""/>
  </variables>
  <nodes>
    <start Name="start0">
      <actions>
        <action>
          <REQUEST Name="getMatchedDomains" ServiceName="BCM_MASTER" AssignToVar="domainValues"/>
          <TO_DOCVAR AssignToVar="matchedDomainValues">
            <TO_XML SelectList="$domainValues"/>
          </TO_DOCVAR>
          <REQUEST Name="getProgramIDOptions" ServiceName="BCM_MASTER" AssignToVar="programIDValues">
            <LEGAL_ENT_NBR Value="{$domainValues/LEGAL_ENT/LEGAL_ENT_NBR/@Value}"/>
          </REQUEST>
        </action>
      </actions>
      <next_nodes>
        <next_node Name="Address Quality Dashboard"/>
      </next_nodes>
    </start>
    <ui_form2 Name="Address Quality Dashboard" ShowInBreadCrumbs="SHOW" Template="AddQualityDashBoard.pgl" InputFormVar="pglFormInput" OutputFormVar="pglFormOutput">
      <pre_actions>
        <action>
          <IF_TEST Test="$thisParam/BUTTON_ID/@Value='SYS_RELOAD' and $thisParam/FILTER_ID/@Value='searchResultsTable'">
            <THEN>
              <REQUEST Name="getAddrQltySearchResults" AssignToVar="searchResults" ServiceName="BCM_MASTER">
                <ACTION_NAME Value="EXPORT"/>
                <!--TO_XML SelectList="$thisParam/*"/-->
                <TO_XML SelectList="$matchedDomainValues/LEGAL_ENT"/>
                <TO_XML SelectList="$programIDValues/MKTNG_PGM"/>
              </REQUEST>
            </THEN>
            <ELSE>
              <IF_TEST Test="($thisParam/SHOW_SEARCH_RESULTS/@Value='TRUE' or $thisParam/START_COUNT/@Value>=0)">
                <THEN>
                  <REQUEST Name="getAddrQltySearchResults" AssignToVar="searchResults" ServiceName="BCM_MASTER">
                    <TO_XML SelectList="$thisParam/*"/>
                    <!--<TO_XML SelectList="$matchedDomainValues/LEGAL_ENT"/>-->
                    <TO_XML SelectList="$programIDValues/MKTNG_PGM"/>
                  </REQUEST>
                </THEN>
              </IF_TEST>
            </ELSE>
          </IF_TEST>
          <TO_DOCVAR AssignToVar="pglFormInput">
            <ROOT>
              <TO_XML SelectList="$matchedDomainValues/*"/>
              <TO_XML SelectList="$programIDValues/*"/>
              <TO_XML SelectList="$searchResults"/>
            </ROOT>
          </TO_DOCVAR>
        </action>
      </pre_actions>
      <post_actions>
        <action>
          <IF_TEST Test="$userAction='SEARCH'">
            <THEN>
              <SET Property="SHOW_SEARCH_RESULTS" DocVar="thisParam" FromValue="TRUE"/>
              <SET DocVar="thisParam" Property="START_COUNT" FromValue="0"/>
            </THEN>
            <ELSE>
              <IF_TEST Test="$thisParam/BUTTON_ID/@Value='LOAD_PROGRAM_LIST'">
                <THEN>
                  <REQUEST Name="getMatchedDomains" ServiceName="BCM_MASTER" AssignToVar="domainValues"/>
                  <REQUEST Name="getProgramIDOptions" AssignToVar="programIDValues" ServiceName="BCM_MASTER">
                    <SOURCE Value="SEARCH"/>
                    <LEGAL_ENT_NBR Value="{$domainValues/LEGAL_ENT[LEGAL_ENT_NAME/@Value=$thisParam/LEGAL_ENT_NAME/@Value]/LEGAL_ENT_NBR/@Value}"/>
                  </REQUEST>
                  <TO_DOCVAR AssignToVar="searchResults">
                    <ROOT/>
                  </TO_DOCVAR>
                  <SET Property="SHOW_LOAD_SEARCH_RESULTS" DocVar="thisParam" FromValue="FALSE"/>
                  <SET Property="START_COUNT" DocVar="thisParam" FromValue="-1"/>
                </THEN>
              </IF_TEST>
            </ELSE>
          </IF_TEST>
        </action>
      </post_actions>
      <if_cond Value="$userAction ='SEARCH'">
        <next_nodes OutputVar="{outputXml,xml}">
          <next_node Name="Address Quality Dashboard" Description=""/>
        </next_nodes>
      </if_cond>
      <else_if_cond Value="$userAction ='LOAD_PROGRAM_LIST'">
        <next_nodes OutputVar="{outputXml,xml}">
          <next_node Name="Address Quality Dashboard" Description=""/>
        </next_nodes>
      </else_if_cond>
      <else_if_cond Value="true()">
        <next_nodes OutputVar="{outputXml,xml}">
          <next_node Name="done2" Description=""/>
        </next_nodes>
      </else_if_cond>
    </ui_form2>
    <done Name="done2">
      <actions/>
      <next_nodes/>
    </done>
  </nodes>
  <mgcview>
    <mgcdashboard location="10,10"/>
    <mgcnodes>
      <start0 font="Times New Roman,0,9" componentConnect="true" componentIconBorder="false" componentTextColor="80,80,80" componentBorderColor="255,255,255" freeze="false" visible="true" fade="false" fadeConnectors="false" shapeKey="ICONISH" snapPointKey="REGULAR" leadingEdge="5" trailingEdge="5" topGap="3" bottomGap="2" location="121,213" size="732,534">
        <iconProps iconfile="z1start.gif"/>
      </start0>
      <mgcnode Name="Address Quality Dashboard" font="Times New Roman,0,9" componentConnect="true" componentIconBorder="false" componentTextColor="80,80,80" componentBorderColor="255,255,255" freeze="false" visible="true" fade="false" fadeConnectors="false" shapeKey="ICONISH" snapPointKey="REGULAR" leadingEdge="5" trailingEdge="5" topGap="3" bottomGap="2" location="340,235" size="1280,724">
        <iconProps iconfile="x1age80.gif"/>
      </mgcnode>
      <done2 font="Times New Roman,0,9" componentConnect="true" componentIconBorder="false" componentTextColor="80,80,80" componentBorderColor="255,255,255" freeze="false" visible="true" fade="false" fadeConnectors="false" shapeKey="ICONISH" snapPointKey="REGULAR" leadingEdge="5" trailingEdge="5" topGap="3" bottomGap="2" location="632,232">
        <iconProps iconfile="z1end.gif"/>
      </done2>
    </mgcnodes>
    <mgcconnectors>
      <start0>
        <nextNodeView wavyConnector="true" connectorTextColor="0,0,0" connectorColor="0,178,178" connStartPointFill="false" connEndPointFill="true" connStartPointOval="true" draggable="true" startpoint="166,235" endpoint="340,257" ctrlRect1="294,233,4,4" ctrlRect2="207,255,4,4"/>
      </start0>
      <mgcnode Name="Address Quality Dashboard">
        <nextNodeView wavyConnector="true" connectorTextColor="0,0,0" connectorColor="0,178,178" connStartPointFill="false" connEndPointFill="true" connStartPointOval="true" draggable="true" startpoint="362,280" endpoint="362,280" ctrlRect1="360,353,4,4" ctrlRect2="267,438,4,4" ctrlRect2Dirty="true" textRect="302,393,26,8">
          <textProps text="$userAction ='SEARCH'"/>
        </nextNodeView>
        <nextNodeView wavyConnector="true" connectorTextColor="0,0,0" connectorColor="0,178,178" connStartPointFill="false" connEndPointFill="true" connStartPointOval="true" draggable="true" startpoint="362,235" endpoint="362,235" ctrlRect1="360,158,4,4" ctrlRect2="251,-33,4,4" ctrlRect2Dirty="true" textRect="289,60,37,8">
          <textProps text="$userAction ='LOAD_PROGRAM_LIST'"/>
        </nextNodeView>
        <nextNodeView wavyConnector="true" connectorTextColor="0,0,0" connectorColor="0,178,178" connStartPointFill="false" connEndPointFill="true" connStartPointOval="true" draggable="true" startpoint="385,257" endpoint="632,254" ctrlRect1="567,255,4,4" ctrlRect2="444,252,4,4"/>
      </mgcnode>
    </mgcconnectors>
    <mgctexts/>
  </mgcview>
  <shutdown_handler>
    <pre_actions>
      <action/>
    </pre_actions>
    <post_actions>
      <action/>
    </post_actions>
    <checkcondition Value=""/>
  </shutdown_handler>
</workflow>